# The command to run, built from the raw link of this gist
# start http://bit.ly/win10boxstarter

# Install Chocolatey
iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))

# Enable empty checksums for Chocolatey
choco feature enable -n allowEmptyChecksums

########################################
# Boxstarter options
########################################
# Allow reboots
$Boxstarter.RebootOk = $true

# Is this a machine with no login password?
$Boxstarter.NoPassword = $false

# Save password securely and auto-login after a reboot
$Boxstarter.AutoLogin = $true
########################################

########################################
# Window Configuration. See http://boxstarter.org/WinConfig
########################################
Write-BoxstarterMessage "Configuring Windows"

Update-ExecutionPolicy Unrestricted

Enable-RemoteDesktop

Set-StartScreenOptions -EnableBootToDesktop -EnableDesktopBackgroundOnStart -EnableShowStartOnActiveScreen -EnableShowAppsViewOnStartScreen -EnableSearchEverywhereInAppsView -EnableListDesktopAppsFirst

Set-WindowsExplorerOptions -EnableShowHiddenFilesFoldersDrives -EnableShowFileExtensions -EnableShowFullPathInTitleBar -DisableOpenFileExplorerToQuickAccess -DisableShowRecentFilesInQuickAccess -DisableShowFrequentFoldersInQuickAccess -EnableExpandToOpenFolder

# This requires restarts, disable for now
# Disable-UAC

Disable-GameBarTips
Disable-InternetExplorerESC

Set-TaskbarOptions -Size Small -Lock -Dock Bottom -Combine Full

# Move-LibraryDirectory "Documents""$env:UserProfile\skydrive\documents"

if (Test-PendingReboot) { Invoke-Reboot }
########################################

########################################
# Windows Features
########################################
Write-BoxstarterMessage "Configuring Windows Features"

cuninst LegacyComponents -source WindowsFeatures -y
cuninst DirectPlay -source WindowsFeatures -y
cuninst SimpleTCP -source WindowsFeatures -y
cuninst SNMP -source WindowsFeatures -y
cuninst WMISnmpProvider -source WindowsFeatures -y
cuninst IIS-Metabase -source WindowsFeatures -y
cuninst TelnetClient -source WindowsFeatures -y
cuninst TFTP -source WindowsFeatures -y
cuninst Xps-Foundation-Xps-Viewer -source WindowsFeatures -y
cuninst WorkFolders-Client -source WindowsFeatures -y
cuninst SMB1Protocol -source WindowsFeatures -y
cuninst Microsoft-Hyper-V-All -source WindowsFeatures -y
cuninst Microsoft-Hyper-V-Tools-All -source WindowsFeatures -y
cuninst Microsoft-Hyper-V-Management-Clients -source WindowsFeatures -y
cuninst Microsoft-Hyper-V-Management-PowerShell -source WindowsFeatures -y
cuninst Microsoft-Hyper-V -source WindowsFeatures -y
cuninst Microsoft-Hyper-V-Hypervisor -source WindowsFeatures -y
cuninst Microsoft-Hyper-V-Services -source WindowsFeatures -y
cuninst Printing-Foundation-Features -source WindowsFeatures -y
cuninst Printing-Foundation-LPRPortMonitor -source WindowsFeatures -y
cuninst Printing-Foundation-LPDPrintService -source WindowsFeatures -y
cuninst Printing-Foundation-InternetPrinting-Client -source WindowsFeatures -y
cuninst FaxServicesClientPackage -source WindowsFeatures -y
cuninst ScanManagementConsole -source WindowsFeatures -y
cuninst DirectoryServices-ADAM-Client -source WindowsFeatures -y
cuninst ServicesForNFS-ClientOnly -source WindowsFeatures -y
cuninst ClientForNFS-Infrastructure -source WindowsFeatures -y
cuninst NFS-Administration -source WindowsFeatures -y
cuninst RasCMAK -source WindowsFeatures -y
cuninst TIFFIFilter -source WindowsFeatures -y
cuninst IsolatedUserMode -source WindowsFeatures -y
cuninst Client-EmbeddedShellLauncher -source WindowsFeatures -y
cuninst Client-EmbeddedBootExp -source WindowsFeatures -y
cuninst Client-EmbeddedLogon -source WindowsFeatures -y
cuninst Client-KeyboardFilter -source WindowsFeatures -y
cuninst Client-UnifiedWriteFilter -source WindowsFeatures -y
cuninst MultiPoint-Connector -source WindowsFeatures -y
cuninst IIS-ManagementService -source WindowsFeatures -y
cuninst IIS-WMICompatibility -source WindowsFeatures -y
cuninst IIS-LegacyScripts -source WindowsFeatures -y
cuninst IIS-LegacySnapIn -source WindowsFeatures -y
cuninst IIS-FTPServer -source WindowsFeatures -y 
cuninst IIS-FTPSvc -source WindowsFeatures -y
cuninst IIS-FTPExtensibility -source WindowsFeatures -y
cuninst MSMQ-Triggers -source WindowsFeatures -y
cuninst MSMQ-ADIntegration -source WindowsFeatures -y
cuninst MSMQ-HTTP -source WindowsFeatures -y
cuninst MSMQ-Multicast -source WindowsFeatures -y
cuninst MSMQ-DCOMProxy -source WindowsFeatures -y
cuninst Printing-PrintToPDFServices-Features -source WindowsFeatures -y
cuninst Printing-XPSServices-Features -source WindowsFeatures -y
cuninst RasRip -source WindowsFeatures -y
cuninst MSRDC-Infrastructure -source WindowsFeatures -y

if (Test-PendingReboot) { Invoke-Reboot }

cinst Windows-Identity-Foundation -source WindowsFeatures -y
cinst MicrosoftWindowsPowerShellV2Root -source WindowsFeatures -y
cinst MicrosoftWindowsPowerShellV2 -source WindowsFeatures -y
cinst Internet-Explorer-Optional-amd64 -source WindowsFeatures -y
cinst NetFx3 -source WindowsFeatures -y
cinst IIS-WebServerRole -source WindowsFeatures -y
cinst IIS-WebServer -source WindowsFeatures -y
cinst IIS-CommonHttpFeatures -source WindowsFeatures -y
cinst IIS-HttpErrors -source WindowsFeatures -y
cinst IIS-HttpRedirect -source WindowsFeatures -y
cinst IIS-ApplicationDevelopment -source WindowsFeatures -y
cinst IIS-NetFxExtensibility -source WindowsFeatures -y
cinst IIS-NetFxExtensibility45 -source WindowsFeatures -y
cinst IIS-HealthAndDiagnostics -source WindowsFeatures -y
cinst IIS-HttpLogging -source WindowsFeatures -y
cinst IIS-LoggingLibraries -source WindowsFeatures -y
cinst IIS-RequestMonitor -source WindowsFeatures -y
cinst IIS-HttpTracing -source WindowsFeatures -y
cinst IIS-Security -source WindowsFeatures -y
cinst IIS-URLAuthorization -source WindowsFeatures -y
cinst IIS-RequestFiltering -source WindowsFeatures -y
cinst IIS-IPSecurity -source WindowsFeatures -y
cinst IIS-Performance -source WindowsFeatures -y
cinst IIS-HttpCompressionDynamic -source WindowsFeatures -y
cinst IIS-WebServerManagementTools -source WindowsFeatures -y
cinst IIS-ManagementScriptingTools -source WindowsFeatures -y
cinst IIS-IIS6ManagementCompatibility -source WindowsFeatures -y
cinst WAS-WindowsActivationService -source WindowsFeatures -y
cinst WAS-ProcessModel -source WindowsFeatures -y
cinst WAS-NetFxEnvironment -source WindowsFeatures -y
cinst WAS-ConfigurationAPI -source WindowsFeatures -y
cinst IIS-HostableWebCore -source WindowsFeatures -y
cinst WCF-HTTP-Activation -source WindowsFeatures -y
cinst WCF-NonHTTP-Activation -source WindowsFeatures -y
cinst WCF-Services45 -source WindowsFeatures -y
cinst WCF-HTTP-Activation45 -source WindowsFeatures -y
cinst WCF-TCP-Activation45 -source WindowsFeatures -y
cinst WCF-Pipe-Activation45 -source WindowsFeatures -y
cinst WCF-MSMQ-Activation45 -source WindowsFeatures -y
cinst WCF-TCP-PortSharing45 -source WindowsFeatures -y
cinst IIS-CertProvider -source WindowsFeatures -y
cinst IIS-WindowsAuthentication -source WindowsFeatures -y
cinst IIS-DigestAuthentication -source WindowsFeatures -y
cinst IIS-ClientCertificateMappingAuthentication -source WindowsFeatures -y
cinst IIS-IISCertificateMappingAuthentication -source WindowsFeatures -y
cinst IIS-ODBCLogging -source WindowsFeatures -y
cinst IIS-StaticContent -source WindowsFeatures -y
cinst IIS-DefaultDocument -source WindowsFeatures -y
cinst IIS-DirectoryBrowsing -source WindowsFeatures -y
cinst IIS-WebDAV -source WindowsFeatures -y
cinst IIS-WebSockets -source WindowsFeatures -y
cinst IIS-ApplicationInit -source WindowsFeatures -y
cinst IIS-ASPNET -source WindowsFeatures -y
cinst IIS-ASPNET45 -source WindowsFeatures -y
cinst IIS-ASP -source WindowsFeatures -y
cinst IIS-CGI -source WindowsFeatures -y
cinst IIS-ISAPIExtensions -source WindowsFeatures -y
cinst IIS-ISAPIFilter -source WindowsFeatures -y
cinst IIS-ServerSideIncludes -source WindowsFeatures -y
cinst IIS-CustomLogging -source WindowsFeatures -y
cinst IIS-BasicAuthentication -source WindowsFeatures -y
cinst IIS-HttpCompressionStatic -source WindowsFeatures -y
cinst IIS-ManagementConsole -source WindowsFeatures -y
cinst MSMQ-Container -source WindowsFeatures -y
cinst MSMQ-Server -source WindowsFeatures -y
cinst NetFx4-AdvSrvs -source WindowsFeatures -y
cinst NetFx4Extended-ASPNET45 -source WindowsFeatures -y
cinst MediaPlayback -source WindowsFeatures -y
cinst WindowsMediaPlayer -source WindowsFeatures -y
cinst SearchEngine-Client-Package -source WindowsFeatures -y

if (Test-PendingReboot) { Invoke-Reboot }

cinst UrlRewrite -y
cinst IIS-ARR -y
########################################

########################################
# Applications. See https://chocolatey.org/packages
########################################
Write-BoxstarterMessage "Installing Applications"

cinst DotNet3.5 -y
cinst LinkShellExtension -y
cinst GoogleChrome -y
cinst Paint.Net -y
cinst WinDirStat -y
cinst RoboForm -y
cinst Dropbox -y
cinst Launchy -y
cinst Spotify -y
cinst Kdiff3 -y
cinst GitExtensions -y
cinst JRE8 -y
cinst DisplayFusion -y
cinst ConEmu -y
cinst MySql.Workbench -y
cinst TeamViewer -y
cinst WebPI -y
cinst VisualStudioCode -y
cinst WebStorm -y
cinst DataGrip -y
cinst Slack -y
cinst K-LiteCodecPackMega -y
cinst OpenLiveWriter -y
cinst Office365Business -y
cinst VMWareWorkstation -y
cinst nodejs.install

cinst MSSQLServerManagementStudio2014Express -y
if (Test-PendingReboot) { Invoke-Reboot }

# Provide optional product key with: --installargs "/ProductKey YOURKEYHERE"
cinst VisualStudio2015Enterprise -y -packageParameters "--AdminFile http://bit.ly/win10boxstarter-vsadmin"
if (Test-PendingReboot) { Invoke-Reboot }

Install-ChocolateyVsixPackage SpellChecker http://bit.ly/win10boxstarter-vs-spellchecker

Install-ChocolateyVsixPackage SaveAllTheTime http://bit.ly/win10boxstarert-vs-saveallthetime

Install-ChocolateyVsixPackage BuildOnSave ttps://bit.ly/win10boxstarert-vs-buildonsave

# ReSharper
cinst resharper-platform -y

# Additonal software that doesn't have packages
# ESET
# EditPad Pro C:\EditPad\SetupEditPadPro736.exe /silent
# ACDSee
# PreCode
#
# ToDo: Add registery keys
#
# [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\Parameters](time) "Type"="NoSync"(off) "Type"="NTP" (on)
# [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\tzautoupdate](time zone) "Start"=dword:00000003 (off) "Start"=dword:00000004 (on)
########################################

########################################
# SQL Server
########################################
# ToDo: Create SQL Server NuGet package with ability to take Configuration file URL
# See VS package for example: https://chocolatey.org/packages/VisualStudio2015Enterprise
# cinst http://path.to.NuGet.Package
# if (Test-PendingReboot) { Invoke-Reboot }
########################################

########################################
# Taskbar Icons
########################################
Write-BoxstarterMessage "Creating Pinned Taskbar Items"

#Install-ChocolateyPinnedTaskBarItem "$env:programfiles\console\console.exe"
#copy-item (Join-Path (Get-PackageRoot($MyInvocation)) 'console.xml') -Force $env:appdata\console\console.xml

Install-ChocolateyPinnedTaskBarItem "$($Boxstarter.programFiles86)\Google\Chrome\Application\chrome.exe"
Install-ChocolateyPinnedTaskBarItem "$($Boxstarter.programFiles86)\Microsoft VS Code\Code.exe"
Install-ChocolateyPinnedTaskBarItem "$($Boxstarter.programFiles86)\GitExtensions\GitExtensions.exe"
Install-ChocolateyPinnedTaskBarItem "$env:APPDATA\Spotify\Spotify.exe"
Install-ChocolateyPinnedTaskBarItem "$($Boxstarter.programFiles)\ConEmu\ConEmu64.exe"
Install-ChocolateyPinnedTaskBarItem "$($Boxstarter.programFiles86)\Microsoft Visual Studio 14.0\Common7\IDE\devenv.com"
########################################

########################################
# Windows Updates
########################################
Enable-MicrosoftUpdate

Install-WindowsUpdate -AcceptEula -Criteria "IsAssigned=1 and IsHidden=0 and IsInstalled=0" -SuppressReboots
if (Test-PendingReboot) { Invoke-Reboot }

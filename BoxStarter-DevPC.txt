# The command to run, built from the raw link of this gist
# start http://boxstarter.org/package/nr/url?https://raw.githubusercontent.com/Boyan-Kostadinov/BoxStarter/master/BoxStarter-DevPC.txt

$sqlServerConfigurationUrl = "https://raw.githubusercontent.com/Boyan-Kostadinov/BoxStarter/master/SQLServer-Configuration.ini"

########################################
# Boxstarter options
########################################
# Allow reboots
$Boxstarter.RebootOk = $true

# Is this a machine with no login password?
$Boxstarter.NoPassword = $false

# Save password securely and auto-login after a reboot
$Boxstarter.AutoLogin = $true
########################################

########################################
# Window Configuration. See http://boxstarter.org/WinConfig
########################################
Write-BoxstarterMessage "Configuring Windows"

Update-ExecutionPolicy Unrestricted

Enable-RemoteDesktop
Enable-MicrosoftUpdate

Set-StartScreenOptions -EnableBootToDesktop -EnableDesktopBackgroundOnStart -EnableShowStartOnActiveScreen -EnableShowAppsViewOnStartScreen -EnableSearchEverywhereInAppsView -EnableListDesktopAppsFirst

Set-WindowsExplorerOptions -EnableShowHiddenFilesFoldersDrives -EnableShowProtectedOSFiles -EnableShowFileExtensions -EnableShowFullPathInTitleBar -DisableOpenFileExplorerToQuickAccess -DisableShowRecentFilesInQuickAccess -DisableShowFrequentFoldersInQuickAccess -EnableExpandToOpenFolder

Disable-UAC
Disable-GameBarTips
Disable-InternetExplorerESC

Set-TaskbarOptions -Size Small -Lock -Dock Bottom -Combine Full

# Move-LibraryDirectory "Documents""$env:UserProfile\skydrive\documents"

Install-WindowsUpdate -AcceptEula -criteria "IsInstalled=0 and (Type='Driver' or Type='Software')"
if (Test-PendingReboot) { Invoke-Reboot }
########################################

########################################
# Windows Features
########################################
Write-BoxstarterMessage "Configuring Windows Features"

cuninst LegacyComponents -source WindowsFeatures
cuninst DirectPlay -source WindowsFeatures
cuninst SimpleTCP -source WindowsFeatures
cuninst SNMP -source WindowsFeatures
cuninst WMISnmpProvider -source WindowsFeatures
cuninst IIS-Metabase -source WindowsFeatures
cuninst TelnetClient -source WindowsFeatures
cuninst TFTP -source WindowsFeatures
cuninst Xps-Foundation-Xps-Viewer -source WindowsFeatures
cuninst WorkFolders-Client -source WindowsFeatures
cuninst SMB1Protocol -source WindowsFeatures
cuninst Microsoft-Hyper-V-All -source WindowsFeatures
cuninst Microsoft-Hyper-V-Tools-All -source WindowsFeatures
cuninst Microsoft-Hyper-V-Management-Clients -source WindowsFeatures
cuninst Microsoft-Hyper-V-Management-PowerShell -source WindowsFeatures
cuninst Microsoft-Hyper-V -source WindowsFeatures
cuninst Microsoft-Hyper-V-Hypervisor -source WindowsFeatures
cuninst Microsoft-Hyper-V-Services -source WindowsFeatures
cuninst Printing-Foundation-Features -source WindowsFeatures
cuninst Printing-Foundation-LPRPortMonitor -source WindowsFeatures
cuninst Printing-Foundation-LPDPrintService -source WindowsFeatures
cuninst Printing-Foundation-InternetPrinting-Client -source WindowsFeatures
cuninst FaxServicesClientPackage -source WindowsFeatures
cuninst ScanManagementConsole -source WindowsFeatures
cuninst DirectoryServices-ADAM-Client -source WindowsFeatures
cuninst ServicesForNFS-ClientOnly -source WindowsFeatures
cuninst ClientForNFS-Infrastructure -source WindowsFeatures
cuninst NFS-Administration -source WindowsFeatures
cuninst RasCMAK -source WindowsFeatures
cuninst TIFFIFilter -source WindowsFeatures
cuninst IsolatedUserMode -source WindowsFeatures
cuninst Client-EmbeddedShellLauncher -source WindowsFeatures
cuninst Client-EmbeddedBootExp -source WindowsFeatures
cuninst Client-EmbeddedLogon -source WindowsFeatures
cuninst Client-KeyboardFilter -source WindowsFeatures
cuninst Client-UnifiedWriteFilter -source WindowsFeatures
cuninst MultiPoint-Connector -source WindowsFeatures
cuninst IIS-ManagementService -source WindowsFeatures
cuninst IIS-WMICompatibility -source WindowsFeatures
cuninst IIS-LegacyScripts -source WindowsFeatures
cuninst IIS-LegacySnapIn -source WindowsFeatures
cuninst IIS-FTPServer -source WindowsFeatures 
cuninst IIS-FTPSvc -source WindowsFeatures
cuninst IIS-FTPExtensibility -source WindowsFeatures
cuninst MSMQ-Triggers -source WindowsFeatures
cuninst MSMQ-ADIntegration -source WindowsFeatures
cuninst MSMQ-HTTP -source WindowsFeatures
cuninst MSMQ-Multicast -source WindowsFeatures
cuninst MSMQ-DCOMProxy -source WindowsFeatures
cuninst Printing-PrintToPDFServices-Features -source WindowsFeatures
cuninst Printing-XPSServices-Features -source WindowsFeatures
cuninst RasRip -source WindowsFeatures
cuninst MSRDC-Infrastructure -source WindowsFeatures

cinst Windows-Identity-Foundation -source WindowsFeatures
cinst MicrosoftWindowsPowerShellV2Root -source WindowsFeatures
cinst MicrosoftWindowsPowerShellV2 -source WindowsFeatures
cinst Internet-Explorer-Optional-amd64 -source WindowsFeatures
cinst NetFx3 -source WindowsFeatures
cinst IIS-WebServerRole -source WindowsFeatures
cinst IIS-WebServer -source WindowsFeatures
cinst IIS-CommonHttpFeatures -source WindowsFeatures
cinst IIS-HttpErrors -source WindowsFeatures
cinst IIS-HttpRedirect -source WindowsFeatures
cinst IIS-ApplicationDevelopment -source WindowsFeatures
cinst IIS-NetFxExtensibility -source WindowsFeatures
cinst IIS-NetFxExtensibility45 -source WindowsFeatures
cinst IIS-HealthAndDiagnostics -source WindowsFeatures
cinst IIS-HttpLogging -source WindowsFeatures
cinst IIS-LoggingLibraries -source WindowsFeatures
cinst IIS-RequestMonitor -source WindowsFeatures
cinst IIS-HttpTracing -source WindowsFeatures
cinst IIS-Security -source WindowsFeatures
cinst IIS-URLAuthorization -source WindowsFeatures
cinst IIS-RequestFiltering -source WindowsFeatures
cinst IIS-IPSecurity -source WindowsFeatures
cinst IIS-Performance -source WindowsFeatures
cinst IIS-HttpCompressionDynamic -source WindowsFeatures
cinst IIS-WebServerManagementTools -source WindowsFeatures
cinst IIS-ManagementScriptingTools -source WindowsFeatures
cinst IIS-IIS6ManagementCompatibility -source WindowsFeatures
cinst WAS-WindowsActivationService -source WindowsFeatures
cinst WAS-ProcessModel -source WindowsFeatures
cinst WAS-NetFxEnvironment -source WindowsFeatures
cinst WAS-ConfigurationAPI -source WindowsFeatures
cinst IIS-HostableWebCore -source WindowsFeatures
cinst WCF-HTTP-Activation -source WindowsFeatures
cinst WCF-NonHTTP-Activation -source WindowsFeatures
cinst WCF-Services45 -source WindowsFeatures
cinst WCF-HTTP-Activation45 -source WindowsFeatures
cinst WCF-TCP-Activation45 -source WindowsFeatures
cinst WCF-Pipe-Activation45 -source WindowsFeatures
cinst WCF-MSMQ-Activation45 -source WindowsFeatures
cinst WCF-TCP-PortSharing45 -source WindowsFeatures
cinst IIS-CertProvider -source WindowsFeatures
cinst IIS-WindowsAuthentication -source WindowsFeatures
cinst IIS-DigestAuthentication -source WindowsFeatures
cinst IIS-ClientCertificateMappingAuthentication -source WindowsFeatures
cinst IIS-IISCertificateMappingAuthentication -source WindowsFeatures
cinst IIS-ODBCLogging -source WindowsFeatures
cinst IIS-StaticContent -source WindowsFeatures
cinst IIS-DefaultDocument -source WindowsFeatures
cinst IIS-DirectoryBrowsing -source WindowsFeatures
cinst IIS-WebDAV -source WindowsFeatures
cinst IIS-WebSockets -source WindowsFeatures
cinst IIS-ApplicationInit -source WindowsFeatures
cinst IIS-ASPNET -source WindowsFeatures
cinst IIS-ASPNET45 -source WindowsFeatures
cinst IIS-ASP -source WindowsFeatures
cinst IIS-CGI -source WindowsFeatures
cinst IIS-ISAPIExtensions -source WindowsFeatures
cinst IIS-ISAPIFilter -source WindowsFeatures
cinst IIS-ServerSideIncludes -source WindowsFeatures
cinst IIS-CustomLogging -source WindowsFeatures
cinst IIS-BasicAuthentication -source WindowsFeatures
cinst IIS-HttpCompressionStatic -source WindowsFeatures
cinst IIS-ManagementConsole -source WindowsFeatures
cinst MSMQ-Container -source WindowsFeatures
cinst MSMQ-Server -source WindowsFeatures
cinst NetFx4-AdvSrvs -source WindowsFeatures
cinst NetFx4Extended-ASPNET45 -source WindowsFeatures
cinst MediaPlayback -source WindowsFeatures
cinst WindowsMediaPlayer -source WindowsFeatures
cinst SearchEngine-Client-Package -source WindowsFeatures

cinst UrlRewrite -y
cinst IIS-ARR -y
########################################

########################################
# Applications. See https://chocolatey.org/packages
########################################
Write-BoxstarterMessage "Installing Applications"

choco feature enable -n allowEmptyChecksums

cinst DotNet3.5 -y
cinst LinkShellExtension -y
cinst GoogleChrome -y
cinst Paint.Net -y
cinst WinDirStat -y
cinst RoboForm -y
cinst Dropbox -y
cinst Launchy -y
cinst Spotify -y
cinst Kdiff3 -y
cinst GitExtensions -y
cinst JRE8 -y
cinst DisplayFusion -y
cinst ConEmu -y
cinst MySql.Workbench -y
cinst TeamViewer -y
cinst WebPI -y
cinst VisualStudioCode -y
cinst WebStorm -y
cinst DataGrip -y
cinst Slack -y
cinst K-LiteCodecPackMega -y
cinst OpenLiveWriter -y
cinst Office365ProPlus -y
cinst VMWareWorkstation -y

cinst MSSQLServerManagementStudio2014Express -y
if (Test-PendingReboot) { Invoke-Reboot }

# ESET
# EditPad
# ACDSee
# PreCode

#cinst nodejs.install

#cinst visualstudio2015enterprise --installargs "/ProductKey YOURKEYHERE" -y
#if (Test-PendingReboot) { Invoke-Reboot }

#cinst resharper -y
#cinst resharper-platform -y

#Install-ChocolateyVsixPackage SpellChecker https://github.com/EWSoftware/VSSpellChecker/releases/download/v2016.7.28.0/VisualStudio.SpellChecker.vsix

#Install-ChocolateyVsixPackage SaveAllTheTime https://visualstudiogallery.msdn.microsoft.com/ee676c7f-83e8-4ef8-87ab-22a95ae8f1d4/file/100488/15/SaveAllTheTime.vsix

#Install-ChocolateyVsixPackage BuildOnSave https://github.com/pragmatrix/BuildOnSave/releases/download/0.21/BuildOnSave.vsix
########################################

########################################
# SQL Server
########################################
$sqlServerConfigurationFile = "SQLServer-Configuration.ini"
$sqlServerConfigurationFilePath = Join-Path (Join-Path (Get-Item $env:TEMP).FullName "chocolatey") $sqlServerConfigurationFile

Invoke-WebRequest -Uri $sqlServerConfigurationUrl -OutFile $sqlServerConfigurationFilePath

# SQL Server Parameters - https://msdn.microsoft.com/en-us/library/ms144259.aspx
# How to Create the Configuration INI - https://msdn.microsoft.com/en-us/library/dd239405.aspx
cinst MSSQLServer2014Express -y --installargs '"/ConfigurationFile=""$sqlServerConfigurationFilePath"" /SAPWD=""SetYourOwn"""'
if (Test-PendingReboot) { Invoke-Reboot }
########################################

########################################
# Taskbar Icons
########################################
Write-BoxstarterMessage "Creating Pinned Taskbar Items"

#Install-ChocolateyPinnedTaskBarItem "$env:programfiles\console\console.exe"
#copy-item (Join-Path (Get-PackageRoot($MyInvocation)) 'console.xml') -Force $env:appdata\console\console.xml

Install-ChocolateyPinnedTaskBarItem "$($Boxstarter.programFiles86)\Google\Chrome\Application\chrome.exe"
Install-ChocolateyPinnedTaskBarItem "$($Boxstarter.programFiles86)\Microsoft VS Code\Code.exe"
Install-ChocolateyPinnedTaskBarItem "$($Boxstarter.programFiles86)\GitExtensions\GitExtensions.exe"
Install-ChocolateyPinnedTaskBarItem "$env:APPDATA\Spotify\Spotify.exe"
Install-ChocolateyPinnedTaskBarItem "$($Boxstarter.programFiles)\ConEmu\ConEmu64.exe"

#Install-ChocolateyPinnedTaskBarItem "$($Boxstarter.programFiles86)\Microsoft Visual Studio 12.0\Common7\IDE\devenv.exe"
########################################
